# Лабораторная работа 1 - Перемножение матриц

## Описание

В данной лабораторной работе реализовано перемножение матриц с использованием CUDA на GPU. Данный подход позволяет значительно ускорить вычисления по сравнению с традиционным методом на CPU.

## О реализации

- Каждый элемент результирующей матрицы вычисляется отдельным потоком на GPU. Один поток обрабатывает одну строку из первой матрицы и один столбец из второй для получения одного значения в новой матрице. 

- Размеры блоков и сетки задаются в коде. В моем случае каждый блок содержит 32x32 потока (всего 1024 потока выполняются одновременно):

    ```cpp
    int THREADS = 32;
    dim3 threads(THREADS, THREADS); // 32 потока на каждую сторону блока
    dim3 blocks(BLOCKS, BLOCKS); // количество блоков зависит от размера матрицы
    ```

- Каждый поток вычисляет свои индексы строки и столбца:

    ```cpp
    int row = blockIdx.y * blockDim.y + threadIdx.y;
    int col = blockIdx.x * blockDim.x + threadIdx.x;
    ```

  Здесь `blockIdx` указывает на индекс блока в сетке, а `threadIdx` на индекс потока внутри блока.

## Результаты

В таблице ниже показано сравнение времени выполнения кода на CPU и GPU. Как видно из таблицы, распаралеливание дает значительный прирост в скорости, причем выгода больше при использовании большей матрицы.

| Matrix Size   |     CPU      |     GPU      |   Speedup   |
|---------------|--------------|--------------|-------------|
|      100x100  |   0.008913   |   0.049220   |   0.181087  |
|      200x200  |   0.069114   |   0.000205   | 336.815145  |
|      300x300  |   0.260686   |   0.000569   | 457.841317  |
|      400x400  |   0.605237   |   0.000928   | 651.921265  |
|      500x500  |   1.244941   |   0.002076   | 599.661040  |
|      600x600  |   2.135794   |   0.002747   | 777.440027  |
|      700x700  |   4.480873   |   0.005609   | 798.848437  |
|      800x800  |   5.136019   |   0.006144   | 835.921884  |
|      900x900  |   7.970325   |   0.011666   | 683.221104  |
|    1000x1000  |  11.684108   |   0.013430   | 870.009866  |
|    1100x1100  |  16.449266   |   0.021358   | 770.163362  |
|    1200x1200  |  18.993887   |   0.025051   | 758.216518  |
|    1300x1300  |  29.545830   |   0.035240   | 838.418720  |
|    1400x1400  |  35.799448   |   0.039784   | 899.840740  |
|    1500x1500  |  51.777298   |   0.052996   | 977.010225  |
|    1600x1600  |  66.057755   |   0.058685   | 1125.631499 |
|    1700x1700  |  94.862703   |   0.078976   | 1201.154371 |
|    1800x1800  | 101.130688   |   0.085281   | 1185.845851 |
|    1900x1900  | 134.531283   |   0.108793   | 1236.576301 |
|    2000x2000  | 133.268962   |   0.114241   | 1166.561080 |



